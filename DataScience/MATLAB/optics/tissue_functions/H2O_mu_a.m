function [water] = H2O_mu_a(nm, vol_pc)
% function [water] = H2O_mu_a(nm)
% Returns absoprtion spectrum (µ_a) of water (1/cm). Uses data from 
% G. M. Hale and M. R. Querry, "Optical constants of water in the 200nm to
% 2000m wavelength region," Appl. Opt., 12, 555--563, (1973).
%
% Inputs
% nm - wavelength (nm)
% vol_pc - volume percentage of water. Default = 100%. Use a lower
% percentage if water is interspersed with other materials. E.g.
% Skin 72%, Organs 76%, Skeleton 22%, Blood 83%, Adipose 10%, Muscle 76% 
% From M. Sawka, "Body fluid responses and hypohydration during
% exercise-heat stress," Human Performance Physiology, Chp. 6, pp.227-266
%
% Outputs
% Water - water absoprtion spectrum (1/cm)
%
% See also
% prahlhb, collagenSpectrum, melanosome_mu_a

DEFAULT_VOLPC = 100.0;    % default volume percentage

if ~exist('vol_pc', 'var')
    vol_pc = DEFAULT_VOLPC;
end

K = vol_pc / DEFAULT_VOLPC;    % weighting factor

% lambda absorption
% (nm) (1/cm)
data = [200.00 0.069000
225.00 0.027400
250.00 0.016800
275.00 0.010700
300.00 0.0067000
325.00 0.0041800
350.00 0.0023300
375.00 0.0011700
400.00 0.00058000
425.00 0.00038000
450.00 0.00028000
475.00 0.00024700
500.00 0.00025000
525.00 0.00032000
550.00 0.00045000
575.00 0.00079000
600.00 0.0023000
625.00 0.0028000
650.00 0.0032000
675.00 0.0041500
700.00 0.0060000
725.00 0.015900
750.00 0.026000
775.00 0.024000
800.00 0.020000
810.00 0.019858
820.00 0.023907
825.00 0.028000
830.00 0.029069
840.00 0.034707
850.00 0.043000
860.00 0.046759
870.00 0.051999
875.00 0.056000
880.00 0.055978
890.00 0.060432
900.00 0.068000
910.00 0.072913
920.00 0.10927
925.00 0.14400
930.00 0.17296
% 940.00 0.26737
% 950.00 0.39000
% 960.00 0.42000
% 970.00 0.45000
% 975.00 0.45000
% 980.00 0.43000
% 990.00 0.41000
% Values from 940 till 999nm imported from Matcher
940	0.193
941	0.202
942	0.211
943	0.22
944	0.229
945	0.238
946	0.25
947	0.262
948	0.274
949	0.286
950	0.298
951	0.31174
952	0.32548
953	0.33922
954	0.35296
955	0.3667
956	0.3816
957	0.3965
958	0.4114
959	0.4263
960	0.4412
961	0.4495
962	0.4578
963	0.4661
964	0.4744
965	0.4827
966	0.48662
967	0.49054
968	0.49446
969	0.49838
970	0.5023
971	0.50396
972	0.50562
973	0.50728
974	0.50894
975	0.5106
976	0.50888
977	0.50716
978	0.50544
979	0.50372
980	0.502
981	0.4987
982	0.4954
983	0.4921
984	0.4888
985	0.4855
986	0.4822
987	0.4789
988	0.4756
989	0.4723
990	0.469
991	0.4637
992	0.4584
993	0.4531
994	0.4478
995	0.4425
996	0.4372
997	0.4319
998	0.4266
999	0.4213
1000.0 0.36000
1020.0 0.27000
1040.0 0.16000
1060.0 0.12000
1080.0 0.13000
1100.0 0.17000
1120.0 0.52000
1140.0 0.66000
1160.0 0.89000
1180.0 1.0400
1200.0 1.0400
1220.0 0.95000
1240.0 0.88000
1260.0 0.89000
1280.0 0.98000
1300.0 1.1100
1320.0 1.3800
1340.0 1.8300
1360.0 2.7700
1380.0 6.1000
1400.0 12.390
1420.0 22.120
1440.0 28.800
1460.0 28.400
1480.0 21.230
1500.0 17.590
1520.0 14.050
1540.0 11.830
1560.0 9.6700
1580.0 7.9500
1600.0 6.7200
1620.0 5.8200
1640.0 4.9800
1660.0 4.5400
1680.0 4.4900
1700.0 4.4400
1720.0 5.1100
1740.0 6.1400
1760.0 7.1400
1780.0 8.1200
1800.0 8.0300
1820.0 8.9800
1840.0 10.240
1860.0 14.190
1880.0 31.080
1900.0 66.140
1920.0 114.54
1940.0 119.83
1960.0 105.79
1980.0 92.030
2000.0 69.120
2020.0 55.990
2040.0 44.970
2060.0 39.040
2080.0 31.420
2100.0 26.930
2120.0 24.010
2140.0 20.550
2160.0 18.620
2180.0 17.290
2200.0 16.510
2220.0 16.130
2240.0 16.550
2260.0 17.240
2280.0 19.840
2300.0 22.400
2320.0 26.810
2340.0 31.950
2360.0 37.270
2380.0 43.300
2400.0 50.060
2420.0 59.720
2440.0 66.950
2460.0 76.620
2480.0 86.140
2500.0 90.480
2520.0 102.23
2540.0 108.84
2560.0 115.36
2580.0 131.51
2600.0 153.21
2650.0 317.72
2700.0 884.30
2750.0 2696.1
2800.0 5161.2
2850.0 8157.1
2900.0 11613
2950.0 12694
3000.0 11394
3050.0 9888.3
3100.0 7783.1
3150.0 5385.6
3200.0 3628.6
3250.0 2358.6
3300.0 1401.3
3350.0 979.05
3400.0 720.72
3450.0 480.80
3500.0 337.50
3600.0 179.77
3700.0 122.27
3800.0 112.44
3900.0 122.44
4000.0 144.51
4100.0 172.00
4200.0 206.00
4300.0 247.00
4400.0 294.00
4500.0 374.00
4600.0 402.00
4700.0 420.00
4800.0 393.00
4900.0 351.00
5000.0 312.00
5100.0 274.00
5200.0 244.00
5300.0 232.00
5400.0 240.00
5500.0 265.00
5600.0 319.00
5700.0 448.00
5800.0 715.00
5900.0 1325.0
6000.0 2241.0
6100.0 2699.0
6200.0 1784.0
6300.0 1137.0
6400.0 881.00
6500.0 758.00
6600.0 678.00
6700.0 632.00
6800.0 604.00
6900.0 586.00
7000.0 574.00
7100.0 566.00
7200.0 560.00
7300.0 554.00
7400.0 550.00
7500.0 546.00
7600.0 542.00
7700.0 540.00
7800.0 540.00
7900.0 539.00
8000.0 539.00
8200.0 538.00
8400.0 540.00
8600.0 453.00
8800.0 550.00
9000.0 557.00
9200.0 567.00
9400.0 579.00
9600.0 594.00
9800.0 614.00
10000 638.00
10500 792.00
11000 1106.0
11500 1552.0
12000 2084.0
12500 2604.0
13000 2948.0
13500 3193.0
14000 3321.0
14500 3363.0
15000 3368.0
15500 3356.0
16000 3314.0
16500 3260.0
17000 3171.0
17500 3081.0
18000 2974.0
18500 2860.0
19000 2738.0
19500 2604.0
20000 2469.0
30000 1374.0
38000 1194.0
50000 1292.0
60000 1229.0
70000 1034.0
80000 859.00
90000 748.00
1.0000e+05 669.00
2.0000e+05 317.00];

min_nm = min(data(:,1));
max_nm = max(data(:,1));
if any(nm > max_nm) || any(nm < min_nm)
    warning(['Wavelength out of bounds of available numeric data. Minimum numeric wavelength = ' num2str(min_nm) 'nm. Max numeric wavelength = ' num2str(max_nm) 'nm. Extrapolating.'])
    method = 'linear';  % linear method extrapolates better
else
    method = 'pchip';   % interpolates better
end

water = interp1(data(:,1), K*data(:,2), nm, method, 'extrap');
%water = Water/10;   % convert from 1/cm to 1/mm
